红黑树

相对平衡的二叉搜索树，从根节点到叶子节点的长度，最长的路径不会大于最短路径的两倍。

性质，每个叶子节点是红的，或者黑的。根节点是黑的，叶子节点也是黑色的，红色节点的两个子节点都是黑色的，每个节点到其所有后代的简单路径上的黑色节点的数目是相同的。

自我调整操作，变色和旋转。变色就是红黑树的节点进行两种颜色的互换，旋转又分为左旋和右旋，左旋和右旋是相反的操作，左旋就是将根节点变为左子节点，右子节点变为根节点，右旋就是反过来，将子节点作为右边节点，左子节点作为根节点。



插入操作，因为红黑树是平衡二叉搜索树，采用二分查找的思想进行设计的，每次插入，都需要比较，直到叶子节点。因为插入会改变红黑树的性质，所有插入完成后，会对红黑树进行调整，让插入后的红黑树重新变成一个完整的红黑树。

删除操作，同样更加复杂，因为删除非叶子节点，红黑树的性质会发生更大的变化



平衡二叉树一般指平衡二叉搜索树

红黑树与平衡二叉树的优略点比较。

二者的时间复杂度是相同的都是`O(log（N）)`

 红黑树不追求`完全的平衡` ，追求相对的平衡，红黑树是用非严格的平衡来减少节点插入调整的操作，红黑树中任何不平衡最多需要三步自我调整操作解决，而平衡二叉树，自我调整操作远比红黑树要多的多。

两种数据结构在进行插入操作时，都是采用两次旋转操作就可以平衡，且每次操作都是`O(1)+O(log(N))`的，二者时相同的

但是在删除操作时，红黑树最多只要调整三次，平衡二叉树需要将删除节点的子路径全部调整一下,这样就很慢`O（log（N）`   这样相比，红黑树在删除操作就是`O(1)` 

所以其实红黑树出现查找速度略逊于平衡树，因为不是完全平衡的，但是维护强于平衡二叉树，所以红黑树是功能、性能、空间开销折中的情况，红黑树与平衡树相比，更加稳定。

在实际应用中，若需要的数据查找的次数远大于插入和删除，我们一般选择平衡二叉树。





B树

B树是为磁盘或者其他直接存储的辅助存储设备而设计的一种平衡搜索树。B树类似与红黑树，但是B树在降低`I/O`操作方面要更好一点。多数数据库都是采用B树或者B树的变种来存储信息



B树与红黑树不同之处是B树可以有很多个孩子，从几个到几千个，这就提到了B树的阶数，一个M阶的B树，子节点最多是M个。所以一个B树的高度要远小于红黑树。在查找的时候，虽然时间复杂度都是`log（N）`  ，但实际上B树的查找速度远小于红黑树。

B树的一个节点中有很多个内部节点，如果内部节点包含`x.n` 个关键字，那么 此节点就有 `x.n + 1` 个孩子，每个节点会被`x.n ` 个关键字分成`x.n+1` 个子域，每个子域对应着一个孩子，当在B树种查找一个关键字时，会根据 `x.n` 个属性进行比较，做出一个`x.n+1` 路的选择 

为什么B树是为磁盘来工作的呢？

磁盘查找数据需要物理时间，因为磁盘查找某一个位置上的数据时是很慢的，需要从一个地址移动到零一地址，每次移动都需要花`8-11ms`的时间，假设在一个红黑树上查找数据，就会有很多次移动的时间，每次查找可能会跳转很多次。但是每次计算机查找数据一次就可以读取一页的数据，B树就是利用了这个，所以用B树查找数据，磁盘转动的次数就会大大减少。



B树又被称为平衡多路查找树，与二叉查找树相比，B树有很多路，且每条路在根节点中存一个关键字，这些关键字是以一定的顺序排序的。

每个非终端结点中包含有n个关键字信息： `(n，P0，K1，P1，K2，P2，......，Kn，Pn)。`其中：
    a)  Ki (i=1...n)为关键字，且关键字按顺序升序排序K(i-1)< Ki。 
    b)  Pi为指向子树根的接点，且指针P(i-1)指向子树种所有结点的关键字均小于Ki，但都大于K(i-1)。 
    c)  关键字的个数n必须满足：` [ceil(m / 2)-1]<= n <= m-1`



B树的操作

插入、删除、搜索

搜索，从根节点进行搜索，首先判断查找数据是否在当前节点上，若没有，根据关键字条件来查找信息存储在那一条子路径上，同理直到找到为止。



查找，先搜索，判断是否存在。若不存在，找到相应的叶子节点的位置进行插入，若空间满了，则需要进行分裂调整。

删除 判断删除内容是否在叶子节点上，若在，则直接删除，若此时B树性质发生变化，就需要调整。若节点并非叶子节点，先进行借用操作，然后在进行删除

调整操作

分裂、借用、合并

分裂，将一半的叶子数量的关键字元素，分裂到新的相邻右节点中，中间值关键字移到父节点中，若父节点也是满的，那么就需要对父节点进行分裂，直到成功。若根节点中插入新的元素，空间满了，则原来的根节点上移成为新的根节点，原来的根节点，分裂为两个成为子节点。

借用，找出该节点中子树最小关键字代替该关键字，

合并，当B树的子节点的关键比较少的话，不符合规则，就会对子节点进行合并



B树与红黑树相比，地址查找次数变小，总体的查找性能应该是降低的，但是更适合计算机磁盘查找

B树的阶数一般是要大于等于3的

B树上的算法执行时间主要由读写磁盘的次数来决定，故一次I/O才足以应该读写更多的信息，因此B树的节点规模一般以一个磁盘页为单位，一个节点的包含的关键字及其孩子个数取决于磁盘页的大小



B+树 

B+树 是 B 树的变种，有着比B树跟高的查询效率

B+树每个非叶子节点不存卫星数据，B树每个节点要存`m-1` 个卫星数据 还有 m 个索引 ，每个索引指向子树,B+树中每个结点存储`m` 个元素，每个非叶子结点不存储卫星数据，只存储索引。

所有叶子结点连接在一起，是一个有序链表。



B树和B+树的区别

B树每个结点都存储数据，而B+树只要叶子结点才会存储数据。所以B+树与B树相比，更加矮胖，磁盘转换速度更小，同样B+树查找更加稳定，因为每次都需要查找到叶子结点，B树可能在在非叶子结点就找到数据了，

范围查找，B树查找需要不断依赖中序遍历，首先用二分查找找到范围下限，然后不断通过中序遍历找到上限，才能找到范围，但是B+树就不需要这样，只要通过二分查找一直向下找，直到直到不符合要求就可以的，更快。

B+树所有叶子结点都连接在一起，更有利与范围查找.



因为 数据库查找操作一般都是采用范围查找，鉴于B+树拥有优秀的范围查找性能，所有很多数据库的存储引擎都是采用的是B+树 ,比如`MySQL` 数据库的`InnorDB` 引擎。