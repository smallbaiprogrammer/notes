垃圾回收

Java中如何判断对象已死

1. 计数算法

   当一个对象被引用，计数器加一，引用失效，计数器减一

   但是这个算法存在着一个缺陷，如果两个对象互相引用，那么计数器始终不为零，那么对象就始终不会被回收。

2. 可达性分析算法

   这里要提到 `GC roots` ，用`GC roots`的根对象，作为起始节点级，从这些节点开始，根据引用关系，向下搜索，搜素的路径称为引用链，如果某个对象没有与引用链相连，则证明这个对象不可达，这个对象就是一个可回收的对象。

   在Java技术体系中，可被作为`GC roots` 的对象有以下几种

   - 在虚拟机栈（栈帧中的本地变量表）中引用的对象，譬如各个线程被调用的方法堆栈中使用的参数、局部变量、临时变量等。
   - 在方法区中类静态属性引用的对象，譬如Java类的引用类型静态变量
   - 在方法区中常量引用的对象，譬如字符串常量池里的引用。
   - 本地方法栈中引用的对象
   - Java虚拟机内部的引用，比如`Class` 对象，一些异常对象，还有加载器等等。
   - 所有同步锁持有的对象

垃圾回收算法

1. 分代算法
2. 标记回收算法
3. 标记整理算法
4. 标记复制算法

垃圾回收器 `G1` 